(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4578:function(e,t,n){Promise.resolve().then(n.bind(n,6774))},6774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var a=n(7437),r=n(2265),c=n(6463),i=n(8614),s=n(815),o=n(3039),l=n(6073);function u(){let e=(0,c.useRouter)(),[t,n]=(0,r.useState)([]);(0,r.useEffect)(()=>{let t=sessionStorage.redirect;delete sessionStorage.redirect,t&&t!==location.href&&e.push(t)},[e]),(0,r.useEffect)(()=>{(async function(){await (0,l.k2)(),n(await (0,l.iM)())})()},[]);let u=async e=>{n(e)};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Bar Curionへようこそ"}),(0,a.jsx)(o.Z,{onSearch:u}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,a.jsx)(s.Z,{recipe:e},e.id))})]})}},5170:function(e,t,n){"use strict";n.d(t,{K:function(){return a}});let a=e=>"".concat("/bar-curion").concat(e)},6463:function(e,t,n){"use strict";var a=n(1169);n.o(a,"useRouter")&&n.d(t,{useRouter:function(){return a.useRouter}})},8614:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(7437),r=n(7138);function c(e){let{children:t}=e;return(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)("header",{className:"py-4",children:(0,a.jsx)("nav",{children:(0,a.jsxs)("ul",{className:"flex space-x-4",children:[(0,a.jsx)("li",{children:(0,a.jsx)(r.default,{href:"/",children:"ホーム"})}),(0,a.jsx)("li",{children:(0,a.jsx)(r.default,{href:"/recipes",children:"レシピ一覧"})}),(0,a.jsx)("li",{children:(0,a.jsx)(r.default,{href:"/graph",children:"関係グラフ"})}),(0,a.jsx)("li",{children:(0,a.jsx)(r.default,{href:"/admin",children:"管理画面"})})]})})}),(0,a.jsx)("main",{children:t}),(0,a.jsx)("footer",{className:"py-4 mt-8 border-t",children:(0,a.jsx)("p",{children:"\xa9 2024 Bar Curion"})})]})}},815:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(7437);n(6648);var r=n(7138);function c(e){let{recipe:t}=e;return(0,a.jsxs)("div",{className:"border p-4 rounded shadow",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:t.name}),(0,a.jsx)("p",{className:"text-gray-600 mb-2",children:t.category}),(0,a.jsxs)("p",{className:"mb-2",children:["材料: ",t.ingredients.length,"種類"]}),(0,a.jsx)(r.default,{href:"/recipes/".concat(t.id),className:"text-blue-500 hover:underline",children:"詳細を見る"})]})}},3039:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(7437),r=n(2265),c=n(6073);function i(e){let{onSearch:t}=e,[n,i]=(0,r.useState)(""),[s,o]=(0,r.useState)("simple"),l=async e=>{e.preventDefault();try{let e=await (0,c.s8)(n,"advanced"===s);t(e)}catch(e){console.error("Search error:",e)}};return(0,a.jsxs)("form",{onSubmit:l,className:"mb-4",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("label",{className:"mr-4",children:[(0,a.jsx)("input",{type:"radio",value:"simple",checked:"simple"===s,onChange:()=>o("simple")}),"簡易検索"]}),(0,a.jsxs)("label",{children:[(0,a.jsx)("input",{type:"radio",value:"advanced",checked:"advanced"===s,onChange:()=>o("advanced")}),"高度な検索"]})]}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"simple"===s?"レシピ名、材料、カテゴリーでレシピを検索...":"例: ingredients:ジン category:クラシック",className:"w-full p-2 border rounded  text-black"}),(0,a.jsx)("button",{type:"submit",className:"mt-2 bg-blue-500 text-white px-4 py-2 rounded",children:"検索"}),"simple"===s&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:'ヒント: 複数のキーワードはAND検索になります。完全一致検索には""を使用してください。 例: "ドライ マティーニ" ジン'}),"advanced"===s&&(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"高度な検索: キーを指定して検索できます（キー: name, ingredients, ingredients.name, ingredients.type, ingredients.amount, instructions, category:）。 標準は完全一致で、前方一致には末尾に*、後方一致には先頭に*を使用できます。 除外検索にはキーの前に-を付けてください。 ingredientsは詳細なキーを指定しない場合は全項目が検索対象になります。 例: -ingredients:クリーム,*ティーニ name:ホッパー"})]})}},6073:function(e,t,n){"use strict";n.d(t,{Fu:function(){return x},wb:function(){return p},iM:function(){return g},k2:function(){return f},s8:function(){return j}});var a=n(9879),r=n(354),c=n(5170),i=n(3750),s=n(7934);async function o(e,t){let n=function(e){let t=[];function n(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("alcohl_contents"==e);else{if("ingredients"==e){let a=t.map(e=>e.startsWith("*")&&e.endsWith("*")?"val.toString().match(/".concat(e.slice(1,-1),"/i)"):e.startsWith("*")?"val.toString().match(/".concat(e.slice(1),"$/i)"):e.endsWith("*")?"val.toString().match(/^".concat(e.slice(0,-1),"/i)"):'val.toString() == "'.concat(e,'"')).join(" || ");return n?"!@.".concat(e,".some(function($i){return (Object.values($i).some(function(val) { return (").concat(a,") }))})"):"@.".concat(e,".some(function($i){return (Object.values($i).some(function(val) { return (").concat(a,") }))})")}if(e.startsWith("ingredients.")){let a=e.split(".")[1],r=t.map(e=>e.startsWith("*")&&e.endsWith("*")?"$i.".concat(a,".match(/").concat(e.slice(1,-1),"/i)"):e.startsWith("*")?"$i.".concat(a,".match(/").concat(e.slice(1),"$/i)"):e.endsWith("*")?"$i.".concat(a,".match(/^").concat(e.slice(0,-1),"/i)"):"$i.".concat(a,' == "').concat(e,'"')).join(" || ");return n?"!@.ingredients.some(function($i){ return (".concat(r,") })"):"@.ingredients.some(function($i){ return (".concat(r,") })")}{let a=t.map(t=>t.startsWith("*")&&t.endsWith("*")?"@.".concat(e,".match(/").concat(t.slice(1,-1),"/i)"):t.startsWith("*")?"@.".concat(e,".match(/").concat(t.slice(1),"$/i)"):t.endsWith("*")?"@.".concat(e,".match(/^").concat(t.slice(0,-1),"/i)"):"@.".concat(e,' == "').concat(t,'"')).join(" || ");return n?"!(".concat(a,")"):"(".concat(a,")")}}}return Object.entries(e).forEach(e=>{let[a,r]=e;console.log("key:",a),console.log("values:",r,Array.isArray(r));let c=!1;"exclude"===a?0!==Object.keys(r).length&&(c=!0,a=Object.keys(r)[0],r=r[a],console.log("key:",a),console.log("values:",r),t.push("".concat(n(a,r,c)))):t.push("".concat(n(a,r,c)))}),t.length>0?"$[?(".concat(t.join(" && "),")]"):"$[*]"}(i.parse(e,{keywords:["ingredients","name","ingredients.name","ingredients.type","ingredients.amount","instructions","category"],ranges:["alcohol_content"],alwaysArray:!0,offsets:!1}));return console.log("JsonPath Query:",n),(0,s.j)({path:n,json:t,eval:"native"}).map(e=>e.id)}let l=null,u=null,d=null;async function h(e){let t=new a.z,n=new r.P(t,{});try{let t;{let n=await fetch((0,c.K)(e));if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));t=await n.json()}n.data=t,await n.write()}catch(e){throw console.error("Error in initDb:",e),e}return n}async function m(e){let t=e.data.cocktails,n=e.data.ingredients;return t.map(e=>({...e,ingredients:e.ingredients.map(e=>{let t=n.find(t=>t.id===e.ingredient_id);return t?{...e,...t,products:t.products.map(e=>({...e,product_id:e.product_id}))}:e})}))}async function f(){l||(l=await h("/data/recipes.json")),u||(u=await h("/data/graph-data.json")),d||(d=await m(l))}async function g(){return await f(),l.data.cocktails}async function p(e){return await f(),l.data.cocktails.find(t=>t.id===parseInt(e))||null}async function x(){return await f(),u.data}async function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await f();let n=l,a=n.data.cocktails,r=n.data.ingredients;if(t)try{let t=await o(e,d);console.log(t);let n=Array.from(t).map(e=>p(e)),a=await Promise.all(n);return console.log(a),a}catch(e){return console.error("Advanced search error:",e),[]}else{let t=e.match(/"[^"]+"|[^\s]+/g)||[];return a.filter(e=>t.every(t=>{let n=t.startsWith('"')&&t.endsWith('"'),a=t.replace(/^"|"$/g,"").toLowerCase(),c=e=>{if("string"!=typeof e)return!1;let t=e.toLowerCase();return n?t===a:t.includes(a)};return c(e.name)||c(e.category)||e.ingredients.some(e=>c(e.name))||r.some(t=>c(t.name)&&e.ingredients.some(e=>e.id===t.id))}))}}}},function(e){e.O(0,[138,37,648,971,23,744],function(){return e(e.s=4578)}),_N_E=e.O()}]);